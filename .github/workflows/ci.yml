name: Test Reporter Demo

on:
  push:
    branches: [main, feature-**]
  workflow_dispatch:

jobs:
  test-reporter-demo:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Create sample test files
        run: |
          mkdir -p TestResults
          # Create a sample TRX test file
          cat > TestResults/sample.trx << 'EOF'
          <?xml version="1.0" encoding="UTF-8"?>
          <TestRun xmlns="http://microsoft.com/schemas/VisualStudio/TeamTest/2010">
            <Results>
              <UnitTestResult testName="Test1" outcome="Passed"/>
              <UnitTestResult testName="Test2" outcome="Failed"/>
              <UnitTestResult testName="Test3" outcome="Passed"/>
            </Results>
          </TestRun>
          EOF

      - name: Generate test summary with dorny/test-reporter
        uses: dorny/test-reporter@v1.9.1
        with:
          name: Test Summary Report
          path: "TestResults/*.trx"
          reporter: dotnet-trx
          fail-on-error: false
          list-tests: 'failed'
          only-summary: false